node {
    stage('Checkout SCM'){
        git branch:'jenkins_test', url:'https://github.com/NSPatel-HU/hello-world.git'
    }

    stage('Install node modules'){
        sh "npm install"
    }

    stage('Test'){
        sh "npx ng test --browsers ChromeHeadless --no-watch --code-coverage"
    }

    stage('Scan'){
        steps{
            withSonarQubeEnv('installationName: sq1'){
                sh "npm run sonar"
            }

        }
    }

    stage('Build'){
        sh "npm run build --prod"
    }

    
}